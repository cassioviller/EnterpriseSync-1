# üó∫Ô∏è JORNADA COMPLETA DO CLIENTE - SIGE v9.0
## Mapeamento Detalhado: Proposta ‚Üí Entrega

---

## üó£Ô∏è CONTINUA√á√ÉO DA REUNI√ÉO DE KICKOFF

**üéØ RICARDO (Gestor):** *"Pessoal, vamos mapear cada etapa da jornada do cliente. Preciso que voc√™s pensem em como cada m√≥dulo se conecta com o pr√≥ximo e com o sistema atual."*

**üíª FERNANDO (Arquiteto):** *"Ricardo, vou garantir que cada transi√ß√£o seja autom√°tica. Quando uma proposta for aprovada, ela deve virar obra automaticamente no sistema existente."*

**üóÑÔ∏è PATRICIA (Backend):** *"Fernando, vou criar relacionamentos entre as novas tabelas e as existentes. Um lead vira proposta, proposta vira obra, obra usa funcion√°rios e custos atuais."*

**üìä CARLOS (Or√ßamentos):** *"Patricia, minha engine de or√ßamentos vai usar dados reais de custos hist√≥ricos. Assim teremos or√ßamentos precisos baseados em obras anteriores."*

**üé® CAMILA (Designer):** *"Carlos, cada etapa ter√° uma interface espec√≠fica. O cliente vai acompanhar visualmente o progresso da sua obra em tempo real."*

**üìà MARCOS (Frontend):** *"Camila, vou criar dashboards interativos para cada etapa. O cliente ter√° acesso a um portal para acompanhar tudo."*

**üîó ANDR√â (Integra√ß√µes):** *"Marcos, vou automatizar notifica√ß√µes. Cliente recebe e-mail a cada mudan√ßa de status, com links para acompanhar."*

**üìã JULIANA (Processos):** *"Andr√©, vou definir checkpoints de qualidade em cada etapa. Nada avan√ßa sem aprova√ß√£o dos respons√°veis."*

**üß™ BEATRIZ (QA):** *"Juliana, vou testar toda a jornada end-to-end. Desde o primeiro lead at√© a entrega final."*

---

## üó∫Ô∏è JORNADA COMPLETA MAPEADA

### üìä VIS√ÉO GERAL DA JORNADA (8 ETAPAS)

```
1. CAPTA√á√ÉO DE LEADS ‚Üí 2. QUALIFICA√á√ÉO ‚Üí 3. PROPOSTA ‚Üí 4. OR√áAMENTO ‚Üí 
5. CONTRATO ‚Üí 6. PLANEJAMENTO ‚Üí 7. EXECU√á√ÉO ‚Üí 8. ENTREGA
```

---

### üéØ ETAPA 1: CAPTA√á√ÉO DE LEADS
**Respons√°vel:** Ricardo (CRM) + Andr√© (Integra√ß√µes)

**üìã FUNCIONALIDADES:**
- **Formul√°rio de contato** no site da empresa
- **Landing pages** espec√≠ficas por tipo de estrutura
- **Integra√ß√£o WhatsApp** para atendimento inicial
- **Captura autom√°tica** de dados do lead
- **Classifica√ß√£o inicial** por potencial

**üóÑÔ∏è TABELA NOVA: `lead`**
```sql
CREATE TABLE lead (
    id SERIAL PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    email VARCHAR(120),
    telefone VARCHAR(20),
    empresa VARCHAR(100),
    tipo_estrutura VARCHAR(50), -- Galp√£o, Mezanino, Cobertura, etc.
    area_estimada DECIMAL(10,2),
    orcamento_estimado DECIMAL(12,2),
    origem VARCHAR(50), -- Site, WhatsApp, Indica√ß√£o, etc.
    status VARCHAR(30) DEFAULT 'novo', -- novo, qualificado, perdido
    observacoes TEXT,
    data_contato DATE DEFAULT CURRENT_DATE,
    responsavel_id INTEGER REFERENCES funcionario(id),
    admin_id INTEGER REFERENCES usuario(id),
    created_at TIMESTAMP DEFAULT NOW()
);
```

**üé® INTERFACE:**
- **Dashboard de Leads** com cards visuais
- **Filtros** por origem, status, respons√°vel
- **Timeline** de intera√ß√µes
- **Bot√µes de a√ß√£o** (qualificar, descartar, agendar)

---

### üéØ ETAPA 2: QUALIFICA√á√ÉO DO LEAD
**Respons√°vel:** Ricardo (CRM) + Camila (Interface)

**üìã FUNCIONALIDADES:**
- **Question√°rio de qualifica√ß√£o** estruturado
- **Pontua√ß√£o autom√°tica** do lead (scoring)
- **Agendamento de visita** t√©cnica
- **Hist√≥rico de intera√ß√µes** completo
- **Classifica√ß√£o por prioridade**

**üóÑÔ∏è TABELA NOVA: `lead_interacao`**
```sql
CREATE TABLE lead_interacao (
    id SERIAL PRIMARY KEY,
    lead_id INTEGER REFERENCES lead(id) NOT NULL,
    tipo VARCHAR(30) NOT NULL, -- ligacao, email, whatsapp, visita
    descricao TEXT NOT NULL,
    data_interacao TIMESTAMP DEFAULT NOW(),
    responsavel_id INTEGER REFERENCES funcionario(id),
    admin_id INTEGER REFERENCES usuario(id)
);
```

**üé® INTERFACE:**
- **Perfil completo do lead** com hist√≥rico
- **Formul√°rio de qualifica√ß√£o** passo a passo
- **Agenda integrada** para visitas
- **Score visual** do lead (barras coloridas)

---

### üéØ ETAPA 3: CRIA√á√ÉO DA PROPOSTA
**Respons√°vel:** Carlos (Or√ßamentos) + Camila (Design)

**üìã FUNCIONALIDADES:**
- **Gera√ß√£o autom√°tica** de proposta em PDF
- **Template personalizado** com logo da empresa
- **C√°lculos autom√°ticos** baseados em dados hist√≥ricos
- **M√∫ltiplas vers√µes** da proposta
- **Assinatura digital** integrada

**üóÑÔ∏è TABELA NOVA: `proposta`**
```sql
CREATE TABLE proposta (
    id SERIAL PRIMARY KEY,
    lead_id INTEGER REFERENCES lead(id) NOT NULL,
    numero_proposta VARCHAR(20) UNIQUE NOT NULL, -- PROP-2025-001
    titulo VARCHAR(200) NOT NULL,
    descricao_projeto TEXT,
    area_total_m2 DECIMAL(10,2) NOT NULL,
    valor_total DECIMAL(12,2) NOT NULL,
    prazo_execucao INTEGER, -- dias
    validade_proposta INTEGER DEFAULT 30, -- dias
    status VARCHAR(30) DEFAULT 'enviada', -- enviada, aprovada, rejeitada, expirada
    arquivo_pdf VARCHAR(255), -- caminho do PDF gerado
    data_envio DATE DEFAULT CURRENT_DATE,
    data_resposta DATE,
    observacoes TEXT,
    responsavel_id INTEGER REFERENCES funcionario(id),
    admin_id INTEGER REFERENCES usuario(id),
    created_at TIMESTAMP DEFAULT NOW()
);
```

**üóÑÔ∏è TABELA NOVA: `proposta_item`**
```sql
CREATE TABLE proposta_item (
    id SERIAL PRIMARY KEY,
    proposta_id INTEGER REFERENCES proposta(id) NOT NULL,
    descricao VARCHAR(200) NOT NULL,
    unidade VARCHAR(20) NOT NULL, -- m¬≤, kg, un
    quantidade DECIMAL(10,4) NOT NULL,
    valor_unitario DECIMAL(10,2) NOT NULL,
    valor_total DECIMAL(12,2) NOT NULL,
    observacoes TEXT,
    admin_id INTEGER REFERENCES usuario(id)
);
```

**üé® INTERFACE:**
- **Editor de proposta** com arrastar e soltar
- **Biblioteca de itens** pr√©-cadastrados
- **Preview em tempo real** do PDF
- **Hist√≥rico de vers√µes** da proposta
- **Dashboard de convers√£o** (propostas ‚Üí contratos)

---

### üéØ ETAPA 4: OR√áAMENTO DETALHADO
**Respons√°vel:** Carlos (Or√ßamentos) + Patricia (Backend)

**üìã FUNCIONALIDADES:**
- **Or√ßamento t√©cnico** detalhado por item
- **C√°lculo de materiais** baseado em projetos similares
- **Estimativa de m√£o de obra** usando dados hist√≥ricos
- **Margem de lucro** configur√°vel
- **Comparativo** com or√ßamentos anteriores

**üóÑÔ∏è TABELA NOVA: `orcamento`**
```sql
CREATE TABLE orcamento (
    id SERIAL PRIMARY KEY,
    proposta_id INTEGER REFERENCES proposta(id) NOT NULL,
    numero_orcamento VARCHAR(20) UNIQUE NOT NULL, -- ORC-2025-001
    versao INTEGER DEFAULT 1,
    
    -- Totais calculados
    total_materiais DECIMAL(12,2) DEFAULT 0.0,
    total_mao_obra DECIMAL(12,2) DEFAULT 0.0,
    total_equipamentos DECIMAL(12,2) DEFAULT 0.0,
    total_outros DECIMAL(12,2) DEFAULT 0.0,
    subtotal DECIMAL(12,2) DEFAULT 0.0,
    margem_lucro_percentual DECIMAL(5,2) DEFAULT 20.0,
    valor_margem DECIMAL(12,2) DEFAULT 0.0,
    valor_final DECIMAL(12,2) DEFAULT 0.0,
    
    status VARCHAR(30) DEFAULT 'em_elaboracao', -- em_elaboracao, finalizado, aprovado
    data_finalizacao DATE,
    observacoes TEXT,
    responsavel_id INTEGER REFERENCES funcionario(id),
    admin_id INTEGER REFERENCES usuario(id),
    created_at TIMESTAMP DEFAULT NOW()
);
```

**üóÑÔ∏è TABELA NOVA: `orcamento_item`**
```sql
CREATE TABLE orcamento_item (
    id SERIAL PRIMARY KEY,
    orcamento_id INTEGER REFERENCES orcamento(id) NOT NULL,
    categoria VARCHAR(50) NOT NULL, -- Material, M√£o de Obra, Equipamento, Outros
    descricao VARCHAR(200) NOT NULL,
    unidade VARCHAR(20) NOT NULL,
    quantidade DECIMAL(10,4) NOT NULL,
    valor_unitario DECIMAL(10,2) NOT NULL,
    valor_total DECIMAL(12,2) NOT NULL,
    fornecedor VARCHAR(100),
    observacoes TEXT,
    admin_id INTEGER REFERENCES usuario(id)
);
```

**üé® INTERFACE:**
- **Planilha interativa** de or√ßamento
- **Calculadora autom√°tica** de totais
- **Gr√°ficos de distribui√ß√£o** de custos
- **Comparativo visual** com projetos similares
- **Aprova√ß√£o eletr√¥nica** do or√ßamento

---

### üéØ ETAPA 5: FORMALIZA√á√ÉO DO CONTRATO
**Respons√°vel:** Ricardo (Processos) + Andr√© (Automa√ß√£o)

**üìã FUNCIONALIDADES:**
- **Gera√ß√£o autom√°tica** de contrato em PDF
- **Cl√°usulas personaliz√°veis** por tipo de obra
- **Cronograma de pagamento** integrado
- **Assinatura digital** das partes
- **Controle de aditivos** contratuais

**üóÑÔ∏è TABELA NOVA: `contrato`**
```sql
CREATE TABLE contrato (
    id SERIAL PRIMARY KEY,
    proposta_id INTEGER REFERENCES proposta(id) NOT NULL,
    orcamento_id INTEGER REFERENCES orcamento(id) NOT NULL,
    numero_contrato VARCHAR(20) UNIQUE NOT NULL, -- CONT-2025-001
    
    -- Dados do cliente
    cliente_nome VARCHAR(100) NOT NULL,
    cliente_documento VARCHAR(20) NOT NULL, -- CPF ou CNPJ
    cliente_endereco TEXT,
    cliente_telefone VARCHAR(20),
    cliente_email VARCHAR(120),
    
    -- Dados do contrato
    valor_total DECIMAL(12,2) NOT NULL,
    prazo_execucao INTEGER NOT NULL, -- dias
    data_inicio DATE NOT NULL,
    data_previsao_fim DATE NOT NULL,
    forma_pagamento TEXT, -- Descri√ß√£o das parcelas
    
    status VARCHAR(30) DEFAULT 'em_elaboracao', -- em_elaboracao, enviado, assinado, em_execucao, finalizado
    arquivo_pdf VARCHAR(255), -- caminho do PDF do contrato
    data_assinatura DATE,
    observacoes TEXT,
    responsavel_id INTEGER REFERENCES funcionario(id),
    admin_id INTEGER REFERENCES usuario(id),
    created_at TIMESTAMP DEFAULT NOW()
);
```

**üóÑÔ∏è TABELA NOVA: `contrato_parcela`**
```sql
CREATE TABLE contrato_parcela (
    id SERIAL PRIMARY KEY,
    contrato_id INTEGER REFERENCES contrato(id) NOT NULL,
    numero_parcela INTEGER NOT NULL,
    descricao VARCHAR(200) NOT NULL, -- Ex: "30% na assinatura"
    valor DECIMAL(12,2) NOT NULL,
    data_vencimento DATE NOT NULL,
    status VARCHAR(30) DEFAULT 'pendente', -- pendente, pago, atrasado
    data_pagamento DATE,
    observacoes TEXT,
    admin_id INTEGER REFERENCES usuario(id)
);
```

**üé® INTERFACE:**
- **Editor de contrato** com templates
- **Assinatura eletr√¥nica** integrada
- **Timeline de pagamentos** visual
- **Dashboard de contratos** por status
- **Alertas de vencimento** autom√°ticos

---

### üéØ ETAPA 6: PLANEJAMENTO DA OBRA
**Respons√°vel:** Juliana (Processos) + Marcos (Frontend)

**üìã FUNCIONALIDADES:**
- **Convers√£o autom√°tica** contrato ‚Üí obra (integra√ß√£o com SIGE v8.0)
- **Cronograma detalhado** por atividades
- **Aloca√ß√£o de funcion√°rios** baseada em disponibilidade
- **Planejamento de materiais** com datas de entrega
- **Cronograma de pagamentos** sincronizado

**üîó INTEGRA√á√ÉO COM SIGE v8.0:**
```sql
-- A tabela 'obra' j√° existe no SIGE v8.0
-- Vamos adicionar campos para integra√ß√£o com contratos

ALTER TABLE obra ADD COLUMN contrato_id INTEGER REFERENCES contrato(id);
ALTER TABLE obra ADD COLUMN cronograma_ativo BOOLEAN DEFAULT TRUE;
ALTER TABLE obra ADD COLUMN percentual_conclusao DECIMAL(5,2) DEFAULT 0.0;
```

**üóÑÔ∏è TABELA NOVA: `cronograma_atividade`**
```sql
CREATE TABLE cronograma_atividade (
    id SERIAL PRIMARY KEY,
    obra_id INTEGER REFERENCES obra(id) NOT NULL,
    nome VARCHAR(200) NOT NULL,
    descricao TEXT,
    data_inicio_prevista DATE NOT NULL,
    data_fim_prevista DATE NOT NULL,
    data_inicio_real DATE,
    data_fim_real DATE,
    percentual_conclusao DECIMAL(5,2) DEFAULT 0.0,
    responsavel_id INTEGER REFERENCES funcionario(id),
    predecessora_id INTEGER REFERENCES cronograma_atividade(id), -- Atividade anterior
    status VARCHAR(30) DEFAULT 'planejada', -- planejada, em_andamento, concluida, atrasada
    observacoes TEXT,
    admin_id INTEGER REFERENCES usuario(id),
    created_at TIMESTAMP DEFAULT NOW()
);
```

**üé® INTERFACE:**
- **Gr√°fico de Gantt** interativo
- **Kanban de atividades** por status
- **Calend√°rio de obra** com marcos
- **Aloca√ß√£o visual** de funcion√°rios
- **Dashboard de progresso** em tempo real

---

### üéØ ETAPA 7: EXECU√á√ÉO DA OBRA
**Respons√°vel:** Integra√ß√£o com SIGE v8.0 existente

**üìã FUNCIONALIDADES (J√Å EXISTENTES):**
- **Controle de ponto** dos funcion√°rios
- **RDO (Relat√≥rio Di√°rio de Obra)** detalhado
- **Gest√£o de custos** por categoria
- **Controle de alimenta√ß√£o** e transporte
- **15 KPIs por funcion√°rio** em tempo real

**üîó NOVAS INTEGRA√á√ïES:**
- **Atualiza√ß√£o autom√°tica** do cronograma baseada no RDO
- **Alertas de desvio** de prazo ou or√ßamento
- **Relat√≥rios de progresso** para o cliente
- **Fotos de progresso** integradas ao RDO

**üóÑÔ∏è TABELA NOVA: `obra_foto`**
```sql
CREATE TABLE obra_foto (
    id SERIAL PRIMARY KEY,
    obra_id INTEGER REFERENCES obra(id) NOT NULL,
    atividade_id INTEGER REFERENCES cronograma_atividade(id),
    arquivo VARCHAR(255) NOT NULL, -- caminho da foto
    descricao TEXT,
    data_foto DATE DEFAULT CURRENT_DATE,
    responsavel_id INTEGER REFERENCES funcionario(id),
    visivel_cliente BOOLEAN DEFAULT TRUE, -- Cliente pode ver esta foto
    admin_id INTEGER REFERENCES usuario(id),
    created_at TIMESTAMP DEFAULT NOW()
);
```

**üé® INTERFACE:**
- **Portal do cliente** com progresso visual
- **Galeria de fotos** da obra
- **Timeline de atividades** conclu√≠das
- **Gr√°ficos de progresso** vs planejado
- **Alertas autom√°ticos** de marcos importantes

---

### üéØ ETAPA 8: ENTREGA E P√ìS-VENDA
**Respons√°vel:** Juliana (Qualidade) + Andr√© (Automa√ß√£o)

**üìã FUNCIONALIDADES:**
- **Checklist de entrega** por tipo de estrutura
- **Inspe√ß√£o de qualidade** com fotos
- **Termo de entrega** digital
- **Garantia autom√°tica** com prazos
- **Pesquisa de satisfa√ß√£o** automatizada

**üóÑÔ∏è TABELA NOVA: `entrega`**
```sql
CREATE TABLE entrega (
    id SERIAL PRIMARY KEY,
    obra_id INTEGER REFERENCES obra(id) NOT NULL,
    data_entrega DATE NOT NULL,
    responsavel_entrega_id INTEGER REFERENCES funcionario(id),
    responsavel_recebimento VARCHAR(100) NOT NULL, -- Nome do cliente
    documento_recebimento VARCHAR(20), -- CPF/CNPJ de quem recebeu
    
    -- Checklist de entrega
    estrutura_completa BOOLEAN DEFAULT FALSE,
    pintura_finalizada BOOLEAN DEFAULT FALSE,
    limpeza_concluida BOOLEAN DEFAULT FALSE,
    documentacao_entregue BOOLEAN DEFAULT FALSE,
    manual_entregue BOOLEAN DEFAULT FALSE,
    garantia_explicada BOOLEAN DEFAULT FALSE,
    
    observacoes TEXT,
    arquivo_termo_entrega VARCHAR(255), -- PDF do termo assinado
    nota_satisfacao INTEGER, -- 1 a 5
    comentario_cliente TEXT,
    status VARCHAR(30) DEFAULT 'entregue', -- entregue, garantia, finalizado
    admin_id INTEGER REFERENCES usuario(id),
    created_at TIMESTAMP DEFAULT NOW()
);
```

**üóÑÔ∏è TABELA NOVA: `pos_venda`**
```sql
CREATE TABLE pos_venda (
    id SERIAL PRIMARY KEY,
    obra_id INTEGER REFERENCES obra(id) NOT NULL,
    tipo VARCHAR(50) NOT NULL, -- garantia, manutencao, reclamacao, elogio
    descricao TEXT NOT NULL,
    data_solicitacao DATE DEFAULT CURRENT_DATE,
    data_atendimento DATE,
    responsavel_id INTEGER REFERENCES funcionario(id),
    status VARCHAR(30) DEFAULT 'aberto', -- aberto, em_andamento, resolvido, fechado
    prioridade VARCHAR(20) DEFAULT 'normal', -- baixa, normal, alta, urgente
    observacoes TEXT,
    admin_id INTEGER REFERENCES usuario(id),
    created_at TIMESTAMP DEFAULT NOW()
);
```

**üé® INTERFACE:**
- **Checklist interativo** de entrega
- **Assinatura digital** do termo
- **Portal de garantia** para o cliente
- **Dashboard de p√≥s-venda** com chamados
- **Pesquisa de satisfa√ß√£o** automatizada

---

## üîó INTEGRA√á√ÉO COMPLETA COM SIGE v8.0

### üìä FLUXO DE DADOS INTEGRADO:

```
LEAD ‚Üí PROPOSTA ‚Üí OR√áAMENTO ‚Üí CONTRATO ‚Üí OBRA (v8.0) ‚Üí ENTREGA
  ‚Üì        ‚Üì         ‚Üì          ‚Üì          ‚Üì           ‚Üì
CRM ‚Üí Comercial ‚Üí T√©cnico ‚Üí Jur√≠dico ‚Üí Execu√ß√£o ‚Üí Qualidade
```

### üîÑ AUTOMA√á√ïES IMPLEMENTADAS:

1. **Lead qualificado** ‚Üí Cria proposta automaticamente
2. **Proposta aprovada** ‚Üí Gera or√ßamento detalhado
3. **Or√ßamento aprovado** ‚Üí Cria contrato
4. **Contrato assinado** ‚Üí Cria obra no SIGE v8.0
5. **Obra iniciada** ‚Üí Ativa cronograma e notifica√ß√µes
6. **Atividade conclu√≠da** ‚Üí Atualiza progresso e notifica cliente
7. **Obra finalizada** ‚Üí Inicia processo de entrega
8. **Entrega conclu√≠da** ‚Üí Ativa garantia e p√≥s-venda

### üìà DASHBOARDS DA JORNADA:

**DASHBOARD COMERCIAL:**
- Funil de convers√£o (Lead ‚Üí Contrato)
- Taxa de convers√£o por vendedor
- Tempo m√©dio por etapa
- Valor m√©dio de contrato
- Pipeline de vendas

**DASHBOARD OPERACIONAL:**
- Obras em andamento vs cronograma
- Desvios de prazo e or√ßamento
- Produtividade por obra
- Custos reais vs or√ßados
- Alertas de qualidade

**DASHBOARD EXECUTIVO:**
- Faturamento por etapa da jornada
- Margem de lucro por projeto
- Satisfa√ß√£o do cliente
- Indicadores de p√≥s-venda
- ROI por tipo de estrutura

---

## ‚úÖ APROVA√á√ÉO DA JORNADA PELA EQUIPE

**üéØ RICARDO:** *"Perfeito! Essa jornada cobre todas as necessidades comerciais e se integra naturalmente com o sistema atual."*

**üíª FERNANDO:** *"A arquitetura est√° s√≥lida. Cada nova tabela se relaciona com as existentes mantendo a integridade."*

**üóÑÔ∏è PATRICIA:** *"As APIs v√£o ser robustas. Vou usar os mesmos padr√µes do SIGE v8.0 para manter consist√™ncia."*

**üìä CARLOS:** *"A engine de or√ßamentos vai ser precisa usando dados hist√≥ricos reais. Isso vai melhorar muito a margem."*

**üé® CAMILA:** *"As interfaces v√£o seguir o mesmo padr√£o visual. O usu√°rio n√£o vai sentir que √© um sistema diferente."*

**üìà MARCOS:** *"Os dashboards v√£o ser interativos e responsivos. Cada stakeholder ter√° sua vis√£o espec√≠fica."*

**üîó ANDR√â:** *"As automa√ß√µes v√£o fazer a jornada fluir naturalmente. Menos trabalho manual, mais efici√™ncia."*

**üìã JULIANA:** *"Os processos de qualidade garantem que nada passe despercebido. Cada etapa tem suas valida√ß√µes."*

**üß™ BEATRIZ:** *"Vou testar toda a integra√ß√£o. Nada vai quebrar no sistema atual, garantido."*

---

## üöÄ STATUS: JORNADA DEFINIDA E APROVADA

**‚úÖ Fase 2 Conclu√≠da**  
**‚û°Ô∏è Pr√≥ximo:** Fase 3 - Implementa√ß√£o do M√≥dulo CRM e Propostas

A jornada completa est√° mapeada e aprovada por todos os especialistas. Agora vamos partir para a implementa√ß√£o dos m√≥dulos!

